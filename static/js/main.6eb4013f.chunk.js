(this["webpackJsonpduck-ts"]=this["webpackJsonpduck-ts"]||[]).push([[0],{31:function(e,t,n){},32:function(e,t,n){},33:function(e,t,n){},35:function(e,t,n){},37:function(e,t,n){},38:function(e,t,n){},44:function(e,t,n){},45:function(e,t,n){},46:function(e,t,n){},47:function(e,t,n){},48:function(e,t,n){},49:function(e,t,n){},50:function(e,t,n){"use strict";n.r(t);var c=n(1),r=n.n(c),a=n(24),i=n.n(a),s=(n(31),n(17)),o=n(13),u=n(3),d=(n(32),n(10)),l="card_list_key",j=JSON.parse(localStorage.getItem(l)||"[]");function f(){localStorage.setItem(l,JSON.stringify(j,null,2))}var h=function(){return j},b=function(e){j.push(e),f()},p=n(6),O=(n(33),n(0));function m(e){return e.replace(/\[\[(.+?)\]\]/g,"<b>$1</b>")}function x(e){return e.replace(/\S/g,"*")}function v(e){return e.replace(/<b>(.+?)<\/b>/g,(function(e){return x(arguments.length<=1?void 0:arguments[1])}))}function w(e){e.defaultState,e.id,e.originalWord;var t=e.sentence,n=(e.articleId,e.wordTileIndex,e.dictResult),r=(e.addTime,Object(c.useState)("hide")),a=Object(p.a)(r,2),i=a[0],s=a[1];function o(){s("hide"===i?"show":"hide")}return"show"===i?Object(O.jsxs)("div",{className:"word-card",onClick:o,children:[Object(O.jsx)("h3",{children:n.headword}),Object(O.jsx)("p",{dangerouslySetInnerHTML:{__html:n.definition}}),Object(O.jsx)("p",{dangerouslySetInnerHTML:{__html:m(t)}})]}):Object(O.jsxs)("div",{className:"word-card",onClick:o,children:[Object(O.jsx)("h3",{children:x(n.headword)}),Object(O.jsx)("p",{dangerouslySetInnerHTML:{__html:v(n.definition)}}),Object(O.jsx)("p",{dangerouslySetInnerHTML:{__html:v(m(t))}})]})}n(35);function g(){return Object(O.jsx)("div",{className:"card-list",children:h().map((function(e,t){return Object(c.createElement)(w,Object(d.a)(Object(d.a)({},e),{},{defaultState:"show",key:t}))}))})}function k(){return Object(O.jsx)(g,{})}var N=n(2),y=n.n(N),S=n(5);n(37),n(38);function L(e){var t=e.title,n=e.imgUrl,c=e.summary,r=e.clickHandler;return Object(O.jsxs)("div",{className:"article-item",onClick:r,children:[Object(O.jsx)("div",{className:"img-wrapper",children:Object(O.jsx)("img",{src:n,className:"img"})}),Object(O.jsx)("div",{className:"title",children:t}),Object(O.jsx)("div",{className:"description",children:c})]})}function C(e){var t=e.sourceUrl,n=Object(c.useState)([]),r=Object(p.a)(n,2),a=r[0],i=r[1];Object(c.useEffect)((function(){Object(S.a)(y.a.mark((function e(){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t).then((function(e){return e.json()}));case 2:n=e.sent,i(n);case 4:case"end":return e.stop()}}),e)})))()}),[t]);var s=Object(u.f)();return Object(O.jsx)("div",{children:a.map((function(e){return Object(O.jsx)(L,{title:e.title,imgUrl:e.img,summary:e.description,clickHandler:function(){return t=e.id,void s.push("/article/".concat(t));var t}},e.id)}))})}n(44);function I(){var e=Object(u.f)();return Object(O.jsxs)("div",{className:"home-banner",children:[Object(O.jsx)("span",{className:"title",children:"\u5212\u8bcd\u7f51\u9875\u7248"}),Object(O.jsx)("div",{className:"card-list-button",onClick:function(){e.push("/cardlist")},children:"\u5361\u7247\u5217\u8868"})]})}n(45);function _(){return Object(O.jsxs)("div",{className:"home-view",children:[Object(O.jsx)(I,{}),Object(O.jsx)(C,{sourceUrl:"/data/section/editor.json"})]})}var W,T=function(e){return Object(S.a)(y.a.mark((function t(){var n;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("/data/article/".concat(e,".json")).then((function(e){return e.json()}));case 2:return n=t.sent,t.abrupt("return",n);case 4:case"end":return t.stop()}}),t)})))()};!function(e){e[e.WORD=0]="WORD",e[e.BLANK=1]="BLANK",e[e.SYMBOL=2]="SYMBOL",e[e.EOL=3]="EOL"}(W||(W={}));n(46);function B(e){var t,n=e.id,c=e.text,r=e.selected,a=e.onClick;return Object(O.jsx)("span",{onClick:function(e){e.stopPropagation(),a(n)},className:(t={"word-tile":!0,selected:r},Object.entries(t).filter((function(e){var t=Object(p.a)(e,2);return t[0],t[1]})).map((function(e){var t=Object(p.a)(e,2),n=t[0];return t[1],n})).join(" ")),children:c})}var D,E,M=n(26),A=n(22),F={init:function(){return Object(S.a)(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(D){e.next=4;break}return e.next=3,fetch("https://cdn.jsdelivr.net/gh/mmjang/dict_hub@main/hub/forms.map.json").then((function(e){return e.json()}));case 3:D=e.sent;case 4:case"end":return e.stop()}}),e)})))()},getBaseForms:function(e){return Object(S.a)(y.a.mark((function t(){var n;return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,F.init();case 2:return n=D[e.toLowerCase()],t.abrupt("return",n||[]);case 4:case"end":return t.stop()}}),t)})))()}},H="https://cdn.jsdelivr.net/gh/mmjang/dict_hub@main";function R(e){return e.replace(/\r|\t|\n/g,"").replace(/^<span.+?>(.*?)<\/span>$/,"$1").trim()}function J(e){if(e.length<=2)return"".concat(H,"/hub/collins/").concat(e,".json");var t=e.slice(0,2);return"".concat(H,"/hub/collins/_").concat(t,"/").concat(e,".json")}function P(e){return U.apply(this,arguments)}function U(){return(U=Object(S.a)(y.a.mark((function e(t){var n,c;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F.getBaseForms(t.toLowerCase());case 2:return n=e.sent,c=[t.toLowerCase()].concat(Object(M.a)(n)).filter((function(e){return E.has(e)})),e.abrupt("return",c);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var K={search:function(e){var t=this;return Object(S.a)(y.a.mark((function n(){var c,r,a,i,s,o,u,d;return y.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t.init();case 2:if(E){n.next=4;break}throw"\u67ef\u6797\u65af\u8fd8\u672a\u521d\u59cb\u5316";case 4:return c=[],n.t0=Promise,n.next=8,P(e);case 8:return n.t1=n.sent.map((function(e){return fetch(J(e)).then((function(e){return e.json()}))})),n.next=11,n.t0.all.call(n.t0,n.t1);case 11:r=n.sent,a=Object(A.a)(r);try{for(a.s();!(i=a.n()).done;){s=i.value,o=Object(A.a)(s);try{for(o.s();!(u=o.n()).done;)d=u.value,c.push(d)}catch(l){o.e(l)}finally{o.f()}}}catch(l){a.e(l)}finally{a.f()}return n.abrupt("return",c.map((function(e){return{headword:e.phrase?e.phrase:e.hwd,phonetics:e.phonetics,shortDefinition:R(e.def_cn),definition:(t=e,R(t.def_cn)+" "+R(t.def_en))};var t})));case 15:case"end":return n.stop()}}),n)})))()},init:function(){return Object(S.a)(y.a.mark((function e(){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F.init();case 2:if(E){e.next=8;break}return e.t0=Set,e.next=6,fetch(H+"/hub/collins.list.json").then((function(e){return e.json()}));case 6:e.t1=e.sent,E=new e.t0(e.t1);case 8:return e.abrupt("return",!0);case 9:case"end":return e.stop()}}),e)})))()}},Y=(n(47),n.p+"static/media/add.9074dc48.svg");function $(e){var t=e.headword,n=(e.phonetics,e.definition),c=e.onAdd;return Object(O.jsxs)("div",{className:"definition",children:[Object(O.jsxs)("div",{className:"hwd-row",children:[Object(O.jsx)("img",{src:Y,onClick:c}),Object(O.jsx)("b",{children:t})]}),Object(O.jsx)("p",{dangerouslySetInnerHTML:{__html:n}})]})}n(48);var z=n.p+"static/media/arrow-up.1ba202ef.svg",Z=n.p+"static/media/arrow-down.200220c5.svg",q=n.p+"static/media/close.53c9f4b6.svg",G=n.p+"static/media/loading.2ce5c7c5.gif";function Q(e){var t=e.word,n=e.sentence,r=void 0===n?"":n,a=e.articleId,i=e.wordIndex,o=e.onClose;console.log("rerender");var u=Object(c.useState)([]),l=Object(p.a)(u,2),j=l[0],f=l[1],h=Object(c.useState)("compact"),m=Object(p.a)(h,2),x=m[0],v=m[1],w=Object(c.useState)(!0),g=Object(p.a)(w,2),k=g[0],N=g[1],L=Object(c.useState)(""),C=Object(p.a)(L,2),I=C[0],_=C[1];Object(c.useEffect)((function(){function e(){return(e=Object(S.a)(y.a.mark((function e(){var n;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,N(!0),_(""),e.next=5,K.search(t);case 5:n=e.sent,f(n),0===n.length&&_("\u6ca1\u67e5\u5230\u8fd9\u4e2a\u8bcd."),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),_("\u7f51\u7edc\u9519\u8bef.");case 13:return e.prev=13,N(!1),e.finish(13);case 16:case"end":return e.stop()}}),e,null,[[0,10,13,16]])})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[t]);var W=Object(O.jsxs)("div",{className:"icon-row",onClick:function(){return v("full"===x?"compact":"full")},children:[Object(O.jsx)("img",{src:"full"===x?Z:z,className:"expand-icon"}),Object(O.jsx)("img",{src:q,className:"close-icon",onClick:o})]});return k?Object(O.jsxs)("div",{className:"dictionary",children:[W,Object(O.jsx)("div",{className:"loading",children:Object(O.jsx)("img",{src:G})})]}):"full"===x?Object(O.jsxs)("div",{className:"dictionary",children:[W,Object(O.jsx)("div",{className:"message",children:I}),j.map((function(e,n){return Object(O.jsx)("div",{className:"definition-wrapper",children:Object(O.jsx)($,Object(d.a)(Object(d.a)({},e),{},{onAdd:function(){return n=e,b({id:Date.now().toString(),originalWord:t,sentence:r,articleId:a,wordTileIndex:i,dictResult:n,addTime:Date.now()}),void s.b.success("\u6dfb\u52a0\u6210\u529f");var n}}))},n)}))]}):Object(O.jsxs)("div",{className:"dictionary compact",children:[W,Object(O.jsx)("div",{className:"message",children:I}),j.map((function(e,t){return Object(O.jsx)("span",{className:"tag",children:e.shortDefinition},t)}))]})}n(49);function V(e){var t=e.title,n=void 0===t?"":t,r=e.content,a=void 0===r?[]:r,i=e.articleId,s=Object(c.useState)(-1),o=Object(p.a)(s,2),u=o[0],d=o[1];function l(e){return j.apply(this,arguments)}function j(){return(j=Object(S.a)(y.a.mark((function e(t){return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:console.log("word select: ",t),m[t].type===W.WORD&&d(t);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e){return function(e){for(var t=/^[A-Za-z-]+/,n=/^([^A-Za-z- ])+/,c=/^\s+/,r=[];e;){var a=void 0;(a=e.match(t))?r.push({word:a[0],type:W.WORD}):(a=e.match(c))?r.push({word:a[0],type:W.BLANK}):(a=e.match(n))&&r.push({word:a[0],type:W.SYMBOL}),a&&(e=e.slice(a[0].length))}return r}(e).concat({type:W.EOL,word:""}).map((function(e,t){var n=b++;return m.push(e),Object(O.jsx)(B,{id:n,text:e.word,selected:u===n,onClick:l},n)}))}function h(e){var t=e.word;return e.type===W.EOL||t.endsWith("?")||t.endsWith(".")||t.endsWith("!")||t.endsWith("...")||t.endsWith('?"')||t.endsWith('!"')||t.endsWith('."')}var b=0,m=[];return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsxs)("div",{className:"reader",onClick:function(){d(-1)},children:[Object(O.jsx)("h3",{children:f(n)}),null===a||void 0===a?void 0:a.map((function(e,t){return Object(O.jsx)("p",{children:f(e.content)},t)}))]}),u>=0?Object(O.jsx)(Q,{word:m[u].word,sentence:function(e){for(var t=e-1,n=e,c="[[".concat(m[e].word,"]]");t>=0&&e-t<50&&!h(m[t]);)c=m[t].word+c,t--;for(;n<m.length&&n-e<50&&!h(m[n]);)n++,c+=m[n].word;return c}(u),articleId:i,wordIndex:u,onClose:function(){return d(-1)}}):null]})}function X(){var e=Object(u.g)().id,t=Object(c.useState)(),n=Object(p.a)(t,2),r=n[0],a=n[1];return Object(c.useEffect)((function(){function t(){return(t=Object(S.a)(y.a.mark((function t(){return y.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=a,t.next=3,T(e);case 3:t.t1=t.sent,(0,t.t0)(t.t1);case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}!function(){t.apply(this,arguments)}()}),[]),Object(O.jsx)("div",{className:"App",children:r?Object(O.jsx)(V,Object(d.a)({},r)):""})}var ee=function(){return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsx)(o.a,{children:Object(O.jsxs)(u.c,{children:[Object(O.jsx)(u.a,{path:"/",exact:!0,children:Object(O.jsx)(_,{})}),Object(O.jsx)(u.a,{path:"/article/:id",children:Object(O.jsx)(X,{})}),Object(O.jsx)(u.a,{path:"/cardlist",children:Object(O.jsx)(k,{})})]})}),Object(O.jsx)(s.a,{})]})},te=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,51)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,a=t.getLCP,i=t.getTTFB;n(e),c(e),r(e),a(e),i(e)}))};i.a.render(Object(O.jsx)(r.a.StrictMode,{children:Object(O.jsx)(ee,{})}),document.getElementById("root")),te()}},[[50,1,2]]]);
//# sourceMappingURL=main.6eb4013f.chunk.js.map